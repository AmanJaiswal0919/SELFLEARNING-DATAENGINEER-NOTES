Category 1- SELECT,WHERE,AGGREGATE

a) Write a query that outputs all of the content of table?
#SELECT *
FROM EMPLOYEES;

b) Write a query that return the names of all the employees in the table?
#SELECT name
FROM EMPLOYEES;

c) Write a query that return all departments in the table (no duplicates)?
#SELECT DISTINCT department
FROM EMPLOYEES;

d) Write a query that returns the name and salary of the professor with the highest salary?
#SELECT Name, MAX(Salary) 
FROM EMPLOYEES;

e) Show first name, last name, and gender of patients whose gender is 'M'?
#SELECT first_name, last_name, gender
FROM patients
WHERE gender = 'M';

f) Show first name and last name of patients who does not have allergies (null)?
#SELECT first_name, last_name
FROM patients
WHERE allergies IS NULL;

g)Query all columns for all American cities in the CITY table with populations larger than 100000. 
The CountryCode for America is USA?
#SELECT *FROM CITY
WHERE countrycode = 'USA'
AND population > 100000;

h) Show first name and last name of patients that weight within the range of 100 to 120?
#SELECT first_name, last_name
FROM patients
WHERE weight BETWEEN 100 AND 120;

i)Update the patients table for the allergies column.
If the patient's allergies is null then replace it with 'NKA'?
#UPDATE patients
SET allergies = 'NKA'
WHERE allergies IS NULL;

j)Show first name and last name concatenated into one column to show their full name?
#SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM patients;

k)Show how many patients have a birth_date with 2010 as the birth year?
#SELECT COUNT(*) AS total_patients
FROM patients
WHERE YEAR(birth_date) = 2010;

l)Show all columns for patients who have one of the following patient_ids:
1,45,534,879,1000?
#SELECT * FROM patients
WHERE patient_id IN (1, 45, 534, 879, 1000);

m)Show the patient id and the total number of admissions for patient_id 579?
#SELECT patient_id, COUNT(*) AS total_admissions
FROM admissions
WHERE patient_id = 579;

n)Based on the cities that our patients live in, show unique cities that are in province_id 'NS'?
#SELECT DISTINCT city
FROM patients
WHERE province_id = 'NS';

o)Write a query to find the first_name, last name and birth date of patients 
who has height greater than 160 and weight greater than 70?
#SELECT first_name, last_name, birth_date
FROM patients
WHERE height > 160
AND weight > 70;

p)Write a query to find list of patients first_name, last_name, and allergies 
where allergies are not null and are from the city of 'Hamilton'?
#SELECT first_name, last_name, allergies
FROM patients
WHERE city = 'Hamilton'
AND allergies IS NOT NULL;

q)Write a SQL query to fetch "FIRST_NAME" from the student table in upper case and use ALIAS name as STUDENT_NAME?
#SELECT UPPER(first_name) AS STUDENT_NAME
FROM student;

r)Write a SQL query to print the first 3 characters of FIRST_NAME from student table?
#SELECT SUBSTRING(first_name, 1, 3)
FROM student;

s)Write a SQL query to find the position of alphabet('a') in the FIRST NAME column 'Shivansh' from student table?
#SELECT INSTR(LOWER(first_name), 'a')
FROM student
WHERE first_name = 'Shivansh';

t) Write a SQL query that fetches the unique values of MAJOR column from student table and print its length?
#SELECT DISTINCT major, LENGTH(major)
FROM student;

u)Write a SQL query to print FIRST_NAME column from student table after replacing 'a' with 'A'?
#SELECT REPLACE(first_name, 'a', 'A')
FROM student;

v)Write a Query the average population for all cities in CITY rounded down to the nearest integer?
#SELECT FLOOR(AVG(population))
FROM CITY;

w)Write a SQL query to show only odd rows from student table?
#SELECT *
FROM student
WHERE student_id % 2 != 0;

x)Write a query that returns the name and salary of the professor with highest salary in the "Computer Science" department?
#SELECT Name, MAX(salary) FROM Employees
WHERE Department = "Computer Science";

y) Write a SQL query CITY names FROM STATION which have vowels (a,e,i,o,u) 
as both their first and last character. your result cannot contain duplicates?
#SELECT DISTINCT CITY FROM STATION  
WHERE (CITY LIKE 'A%' OR CITY LIKE 'E%' OR CITY LIKE '1%' OR CITY LIKE '0%' OR CITY LIKE '%') 
AND (CITY LIKE '%a' OR CITY LIKE '%e' OR CITY LIKE '%' OR CITY LIKE '%0 OR CITY LIKE '%u');  
  
z) Write a SQL query CITY names FROM STATION that either do not start with vowels 
or do not end with vowels. your result cannot contain duplicates?
#SELECT DISTINCT CITY FROM STATION  
WHERE (CITY NOT LIKE 'A%' AND CITY NOT LIKE 'E%' AND CITY NOT LIKE '1%' AND CITY NOT LIKE '0%' AND CITY NOT LIKE 'U%') 
OR (CITY NOT LIKE '%a' AND CITY NOT LIKE '%e' AND CITY NOT LIKE '%i' AND CITY NOT LIKE '%0' AND CITY NOT LIKE '%u');  
  
z-1) Samantha was tasked with calculating the average monthly salaries for all employees 
in EMPLOYEES table but did not realize her keyboard 0 key was broken until 
after completing the calculation Write a query calculating the amount of error 
(actual - miscalculated average monthly salaries) and round it up to the next integer?  
#SELECT CEIL(AVG(SALARY) - AVG(REPLACE(SALARY,'0','")))  
FROM EMPLOYEES;
  
z-2)Write a SQL query the sum of Northern Latitudes (LAT_N) from STATION having values greater than 38.7880 
and less than 137.2345 Truncate your answer to 4 decimal places?  
#SELECT TRUNCATE (SUM(LAT_N),4) FROM STATION WHERE LAT_N>38.7880 
AND LAT_N<137.2345;  

------------------------------------------------------------------------------------------------------------------------------------------
orders
order_id   customer_id   product_id   amount
1             101          501         200
2             101          502         300
3             102          501         150
4             102          501         150
5             103          503         400

Question 1: How many different customers placed orders?
SELECT COUNT(DISTINCT customer_id) AS totalcustomer
FROM orders;
Explanation:
customer_id contains duplicates:
101 appears twice
102 appears twice
103 appears once
Unique customers = 3
Output:
totalcustomer
3

Question 2: Total revenue from all orders?
SELECT SUM(amount) AS totalrevenue
FROM orders;
Explanation:
This gives one single summarized value.
200 + 300 + 150 + 150 + 400 = 1200
Output:
totalrevenue
1200

Question 3: Total revenue per customer?
SELECT customer_id, SUM(amount) AS customerrevenue
FROM orders
GROUP BY customer_id;
Explanation:
customer_id has duplicates, so GROUP BY combines rows.
Output:
customer_id   customerrevenue
101            500
102            300
103            400



